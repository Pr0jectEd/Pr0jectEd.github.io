<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bank Account Management</title>
    <style>
        body {
            font-family: sans-serif;
        }
        .container {
            width: 80%;
            margin: 20px auto;
        }
        .form-group {
            margin-bottom: 15px;
        }
        label {
            display: block;
            margin-bottom: 5px;
        }
        input[type="text"], input[type="number"] {
            width: 100%;
            padding: 8px;
            border: 1px solid #ccc;
            border-radius: 4px;
        }
        button {
            padding: 10px 15px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        button:hover {
            background-color: #45a049;
        }
        #account-details {
            margin-top: 20px;
            border: 1px solid #ccc;
            padding: 10px;
        }
        #transactions-output {
            margin-top: 20px;
            border: 1px solid #ccc;
            padding: 10px;
            height: 200px;
            overflow-y: scroll;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Bank Account Management</h1>

        <h2>Create Account</h2>
        <div class="form-group">
            <label for="ownerName">Owner Name:</label>
            <input type="text" id="ownerName" placeholder="Enter owner name">
        </div>
        <div class="form-group">
            <label for="initialBalance">Initial Balance:</label>
            <input type="number" id="initialBalance" placeholder="Enter initial balance" value="100">
        </div>
        <button id="createAccount">Create Account</button>

        <h2>Account Details</h2>
        <div id="account-details">
            </div>

        <h2>Transactions</h2>
        <div id="transactions-output">
            </div>
    </div>

    <script>
        const ownerNameInput = document.getElementById('ownerName');
        const initialBalanceInput = document.getElementById('initialBalance');
        const createAccountButton = document.getElementById('createAccount');
        const accountDetailsDiv = document.getElementById('account-details');
        const transactionsOutputDiv = document.getElementById('transactions-output');

        let accounts = []; // Array to store accounts
        let currentAccountNumber = 1; // Simulate auto-increment

        createAccountButton.addEventListener('click', () => {
            const ownerName = ownerNameInput.value;
            const initialBalance = parseFloat(initialBalanceInput.value);

            if (ownerName) {
                const newAccount = {
                    ownerName: ownerName,
                    accountNumber: currentAccountNumber++,
                    balance: initialBalance
                };
                accounts.push(newAccount);
                displayAccountDetails(newAccount);
                logTransaction(`Creation of ${initialBalance} | ${ownerName} | ${newAccount.accountNumber}.`);
                ownerNameInput.value = '';
                initialBalanceInput.value = '100';
            } else {
                alert('Please enter owner name.');
            }
        });

        function displayAccountDetails(account) {
            accountDetailsDiv.innerHTML = `
                <h3>Account Details for ${account.ownerName}</h3>
                <p>Account Number: ${account.accountNumber}</p>
                <p>Balance: ${account.balance}</p>
            `;
        }

        function logTransaction(transaction) {
            transactionsOutputDiv.innerHTML += `<p>${transaction}</p>`;
        }

        // ---  Simulated Operations  ---
        // This is where you would call your PHP functions using AJAX

        // Example (replace with AJAX calls):
        //  fetch('/your-php-script.php', {
        //      method: 'POST',
        //      body: JSON.stringify({ action: 'deposit', accountNumber: 1, amount: 200 })
        //  })
        //  .then(response => response.text())
        //  .then(data => {
        //      console.log(data); // Handle response
        //  });
        //
        //  For this example, I'll simulate operations in JavaScript

        //  Simulated Scenario (replace with AJAX calls)
        window.onload = () => {
            // Simulate initial accounts
            const elsa = { ownerName: "Elsa", accountNumber: currentAccountNumber++, balance: 100 };
            const john = { ownerName: "John", accountNumber: currentAccountNumber++, balance: 200 };
            const pat = { ownerName: "Pat", accountNumber: currentAccountNumber++, balance: 300 };

            accounts.push(elsa, john, pat);

            displayAccountDetails(elsa);
            logTransaction(`Creation of 100 | Elsa | ${elsa.accountNumber}.`);
            displayAccountDetails(john);
            logTransaction(`Creation of 200 | John | ${john.accountNumber}.`);
            displayAccountDetails(pat);
            logTransaction(`Creation of 300 | Pat | ${pat.accountNumber}.`);

            // Simulated transactions (replace with AJAX)
            elsa.balance += 200;
            logTransaction(`Transaction: 1 (deposit: 200), Elsa: ${elsa.balance}`);
            displayAccountDetails(elsa);

            let withdrawAmount = 700;
            let elsaBalance = elsa.balance;
            let difference = elsaBalance - withdrawAmount;
            if (difference < -200){
                logTransaction(`Transaction: 2 (withdraw: ${withdrawAmount}), Elsa: Insufficient funds`);
            } else if (difference < 0 && difference > -100){
                let penalty = withdrawAmount * 0.1;
                elsa.balance -= (withdrawAmount + penalty);
                logTransaction(`Transaction: 2 (withdraw: ${withdrawAmount}, penalty: ${penalty}), Elsa: ${elsa.balance}`);
            } else if (difference <= -100 && difference > -200){
                let penalty = withdrawAmount * 0.3;
                elsa.balance -= (withdrawAmount + penalty);
                logTransaction(`Transaction: 2 (withdraw: ${withdrawAmount}, penalty: ${penalty}), Elsa: ${elsa.balance}`);
            } else {
                elsa.balance -= withdrawAmount;
                logTransaction(`Transaction: 2 (withdraw: ${withdrawAmount}), Elsa: ${elsa.balance}`);
            }
            displayAccountDetails(elsa);

            withdrawAmount = 100;
            elsaBalance = elsa.balance;
            difference = elsaBalance - withdrawAmount;
            if (difference < -200){
                logTransaction(`Transaction: 3 (withdraw: ${withdrawAmount}), Elsa: Insufficient funds`);
            } else if (difference < 0 && difference > -100){
                let penalty = withdrawAmount * 0.1;
                elsa.balance -= (withdrawAmount + penalty);
                logTransaction(`Transaction: 3 (withdraw: ${withdrawAmount}, penalty: ${penalty}), Elsa: ${elsa.balance}`);
            } else if (difference <= -100 && difference > -200){
                let penalty = withdrawAmount * 0.3;
                elsa.balance -= (withdrawAmount + penalty);
                logTransaction(`Transaction: 3 (withdraw: ${withdrawAmount}, penalty: ${penalty}), Elsa: ${elsa.balance}`);
            } else {
                elsa.balance -= withdrawAmount;
                logTransaction(`Transaction: 3 (withdraw: ${withdrawAmount}), Elsa: ${elsa.balance}`);
            }
            displayAccountDetails(elsa);

            pat.balance += 400;
            logTransaction(`Transaction: 4 (deposit: 400), Pat: ${pat.balance}`);
            displayAccountDetails(pat);

            let transferAmount = 200;
            let transferTax = transferAmount * 0.2;
            let totalTransferAmount = transferAmount + transferTax;

            difference = pat.balance - totalTransferAmount;
            if (difference < -200){
                logTransaction(`Transaction: 5 (transfer: ${transferAmount} to John), Pat: Insufficient funds`);
            } else {
                pat.balance -= totalTransferAmount;
                john.balance += transferAmount;
                logTransaction(`Transaction: 5 (transfer: ${transferAmount} to John, tax: ${transferTax}), Pat: ${pat.balance}`);
                logTransaction(`Transaction: 5 (receive: ${transferAmount} from Pat), John: ${john.balance}`);
            }
            displayAccountDetails(pat);
            displayAccountDetails(john);

        };

    </script>
</body>
</html>